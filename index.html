<!DOCTYPE html>
<html>
<head>
	<title></title>
<style type="text/css">
	/*body {
		background-color: black;
	}*/
	body {
		transition: background-color .75s
	}
	#container {
		width: 100%;
		text-align: center;
	}
	canvas {
		border: 1px solid black;
		margin-top: 2%;
		display: inline;
		height: 50vh;
	}
</style>
</head>
<body>

<audio src="./tones/c0.wav" id="C0"></audio>
<audio src="./tones/d0.wav" id="D0"></audio>
<audio src="./tones/e0.wav" id="E0"></audio>
<audio src="./tones/f0.wav" id="F0"></audio>
<audio src="./tones/g0.wav" id="G0"></audio>
<audio src="./tones/a0.wav" id="A0"></audio>
<audio src="./tones/b0.wav" id="B0"></audio>

<audio src="./tones/c1.wav" id="C1"></audio>
<audio src="./tones/d1.wav" id="D1"></audio>
<audio src="./tones/e1.wav" id="E1"></audio>
<audio src="./tones/f1.wav" id="F1"></audio>
<audio src="./tones/g1.wav" id="G1"></audio>
<audio src="./tones/a1.wav" id="A1"></audio>
<audio src="./tones/b1.wav" id="B1"></audio>

<audio src="./tones/c2.wav" id="C2"></audio>
<audio src="./tones/d2.wav" id="D2"></audio>
<audio src="./tones/e2.wav" id="E2"></audio>
<audio src="./tones/f2.wav" id="F2"></audio>
<audio src="./tones/g2.wav" id="G2"></audio>
<audio src="./tones/a2.wav" id="A2"></audio>
<audio src="./tones/b2.wav" id="B2"></audio>

<audio src="./tones/c3.wav" id="C3"></audio>
<audio src="./tones/d3.wav" id="D3"></audio>
<audio src="./tones/e3.wav" id="E3"></audio>
<audio src="./tones/f3.wav" id="F3"></audio>
<audio src="./tones/g3.wav" id="G3"></audio>
<audio src="./tones/a3.wav" id="A3"></audio>
<audio src="./tones/b3.wav" id="B3"></audio>

<audio src="./tones/c4.wav" id="C4"></audio>
<audio src="./tones/d4.wav" id="D4"></audio>
<audio src="./tones/e4.wav" id="E4"></audio>
<audio src="./tones/f4.wav" id="F4"></audio>
<audio src="./tones/g4.wav" id="G4"></audio>
<audio src="./tones/a4.wav" id="A4"></audio>
<audio src="./tones/b4.wav" id="B4"></audio>

<audio src="./tones/c5.wav" id="C5"></audio>
<audio src="./tones/d5.wav" id="D5"></audio>
<audio src="./tones/e5.wav" id="E5"></audio>
<audio src="./tones/f5.wav" id="F5"></audio>
<audio src="./tones/g5.wav" id="G5"></audio>
<audio src="./tones/a5.wav" id="A5"></audio>
<audio src="./tones/b5.wav" id="B5"></audio>

<audio src="./tones/c6.wav" id="C6"></audio>
<audio src="./tones/d6.wav" id="D6"></audio>
<audio src="./tones/e6.wav" id="E6"></audio>
<audio src="./tones/f6.wav" id="F6"></audio>
<audio src="./tones/g6.wav" id="G6"></audio>
<audio src="./tones/a6.wav" id="A6"></audio>
<audio src="./tones/b6.wav" id="B6"></audio>

<audio src="./tones/c7.wav" id="C7"></audio>
<audio src="./tones/d7.wav" id="D7"></audio>
<audio src="./tones/e7.wav" id="E7"></audio>
<audio src="./tones/f7.wav" id="F7"></audio>
<audio src="./tones/g7.wav" id="G7"></audio>
<audio src="./tones/a7.wav" id="A7"></audio>
<audio src="./tones/b7.wav" id="B7"></audio>

<audio src="./tones/c8.wav" id="C8"></audio>
<!-- <audio src="./tones/d8.wav" id="D8"></audio>
<audio src="./tones/e8.wav" id="E8"></audio>
<audio src="./tones/f8.wav" id="F8"></audio>  these are way too high
<audio src="./tones/g8.wav" id="G8"></audio>
<audio src="./tones/a8.wav" id="A8"></audio>
<audio src="./tones/b8.wav" id="B8"></audio>

<audio src="./tones/c9.wav" id="C9"></audio> -->

<div id="container">
	<h1>SINGING GLIDER</h1>
	<canvas id="life"></canvas>
</div>

</body>
<script src="./gameoflife.js"></script>
<script type="text/javascript">

	const C1 = document.getElementById('C1')
	const D  = document.getElementById('D')
	const E  = document.getElementById('E')
	const F  = document.getElementById('F')
	const G  = document.getElementById('G')
	const A  = document.getElementById('A')
	const B  = document.getElementById('B')
	const C2 = document.getElementById('C2')
	
	var starting_cells = [
		[0,0,0,0,0,0,0,0],
		[0,0,1,0,0,0,0,0],
		[1,1,1,0,0,0,0,0],
		[0,0,1,1,1,0,0,0],
		[0,0,1,0,1,1,1,0],
		[0,0,1,0,0,0,0,0],
		[0,0,1,0,0,0,0,0],
		[0,0,0,0,0,0,0,0]
	];

	// var starting_cells = [
	// 	[0,1,0,0,0,0,0,1],
	// 	[0,0,1,0,0,0,0,1],
	// 	[1,1,1,0,0,0,0,1],
	// 	[0,0,0,0,0,0,0,0],
	// 	[0,0,0,0,0,0,0,0],
	// 	[0,1,1,1,0,0,0,0],
	// 	[0,0,1,0,0,0,0,0],
	// 	[0,0,0,0,0,0,0,0]
	// ];

	// ideas for melody makers:
	// - weight/momentum (zones are like keys with slow attack, the longer something is in the zone the more you hear the chord associated with the zone)
	// - taper (adjust gain according to population)

	// detect when live cells land on each pad of this matrix
	//
	// v1 - lots of expression but slightly too much dissonance
	//    1 2 3 4 5 6 7 8
	// 1  C G D A E B F C
	// 2  E B F C G D A E 
	// 3  G D A E B F C G
	// 4  B F C G D A E B
	// 5  D A E B F C G D
	// 6  F C G D A E B F
	// 7  A E B F C G D A
	// 8  C G D A E B F C
	//
	// v2 - no expression no dissonance
	//    1 2 3 4 5 6 7 8
	// 1  C G C G C G C G
	// 2  E C E C E C E C 
	// 3  C G C G C G C G
	// 4  E C E C E C E C
	// 5  C G C C G C G C
	// 6  E C E C E C E C
	// 7  C G C G C G C G
	// 8  E C E C E C E C
	//
	// v3 - splitting the matrix into two chord-realms adds nice flavor, maybe could be more interesting on a larger grid
	//    1 2 3 4 5 6 7 8
	// 1  C G C G F A F A
	// 2  E C E C A C A C 
	// 3  C G C G F A F A
	// 4  E C E C A C A C
	// 5  C G C C F A F A
	// 6  E C E C A C A C
	// 7  C G C G F A F A
	// 8  E C E C A C A C

	function playTone (el) {
		el.currentTime = 0;
		el.play()
	}

	var matrix = [
		[() => playTone(C3), () => playTone(G4),  () => playTone(C5),  () => playTone(G6),
		 () => playTone(F3), () => playTone(A4),  () => playTone(F5),  () => playTone(A6)],
		[() => playTone(E3),  () => playTone(C4),  () => playTone(E5),  () => playTone(C6),
		 () => playTone(A3),  () => playTone(C4),  () => playTone(A5),  () => playTone(C6)],
		[() => playTone(C3), () => playTone(G4),  () => playTone(C5),  () => playTone(G6),
		 () => playTone(F3), () => playTone(A4),  () => playTone(F5),  () => playTone(A6)],
		[() => playTone(E3),  () => playTone(C4),  () => playTone(E5),  () => playTone(C6),
		 () => playTone(A3),  () => playTone(C4),  () => playTone(A5),  () => playTone(C6)],
		[() => playTone(C3), () => playTone(G4),  () => playTone(C5),  () => playTone(G6),
		 () => playTone(F3), () => playTone(A4),  () => playTone(F5),  () => playTone(A6)],
		[() => playTone(E3),  () => playTone(C4),  () => playTone(E5),  () => playTone(C6),
		 () => playTone(A3),  () => playTone(C4),  () => playTone(A5),  () => playTone(C6)],
		[() => playTone(C3), () => playTone(G4),  () => playTone(C5),  () => playTone(G6),
		 () => playTone(F3), () => playTone(A4),  () => playTone(F5),  () => playTone(A6)],
		[() => playTone(E3),  () => playTone(C4),  () => playTone(E5),  () => playTone(C6),
		 () => playTone(A3),  () => playTone(C4),  () => playTone(A5),  () => playTone(C6)],
	]

	var params = {
      canvas_id:    'life',
      cell_width:   100,
      cell_height:  100,
	  colorful: false,
      init_cells:   starting_cells
    };


    var game = new GameOfLife(params);

    function play () {
	    var population = 0;
    	game.getCurrentGenCells().forEach((row, y) => {
    		row.forEach((cell,x) => {
    			if (cell.state == 'alive') {
    				population++
    				matrix[y][x]()
    			}
    			
    		})
    	})
    	console.log(population)
    	if (population <= 8) {
    		document.body.style.backgroundColor = 'red'
    		document.getElementById('C8').play()
    	} else {
    		document.body.style.backgroundColor = 'white'
    	}
    }

    function interval () {
    	game.step()
    	play()
    }

    var interval = setInterval(interval, 750);

</script>
</html>